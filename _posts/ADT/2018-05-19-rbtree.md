---
layout: post
title: BBST之红黑树
tags: [ADT]
date: 2018-05-19
---

## 红黑树

红黑树是BBST的一个新类型。线性结构：向量，列表，栈，队列，或是半线性结构的树，非线性结构图。它们都是随时变化的，某一个状态只会存在一瞬间。

但是如果要记录每一个瞬间（快照）需要创建副本，累计消耗O(h+n)的时间和空间。这个显然不能接受，但是要实现O(n+h*logn)这个复杂度，就需要使用不同版本之间的关联性。

我们可以采用这种策略，需要大量共享，少量变化进行更新。每个版本的新增复杂度，仅为O(logn)。

<img src="http://os310ujuc.bkt.clouddn.com/rbt2.png">

### 结构

红黑树，首先必须是真二叉树，每个节点都是非1节点。有红黑节点组成。

- 树根必须为黑色
- 外部节点均为黑色
- 其余节点：若为红色，则只能有黑孩子。 // 红之子，之父必为黑
- 外部节点到根：图中黑节点数目相等 ，即为黑深度

<img src="http://os310ujuc.bkt.clouddn.com/rbt3.png">

图中已经为所有需要的节点添加外界点，即黑节点，但是不标出。

对于第一点，根节点是黑色的，对于第二点，红色的末端节点已经做过预处理，为所有的需要的节点添加外部节点，实际上并不存在，所以已经忽略。对于第三条，每一个红节点其父亲都是黑节点，对于末端叶节点，外部节点也是黑节点（没有标出）。对于第四点，外部节点带根节点，都是为3个黑节点，同样符合。

#### 提升变换

变换前：<img src="http://os310ujuc.bkt.clouddn.com/rbt4.png">

变换后：<img src="http://os310ujuc.bkt.clouddn.com/rbt5.png">


对每一个红色节点都进行提升到黑节点的同级。如图变化。

提升变换之后，所有底层的节点都变成了沿同一水平平齐的高度。

红黑树就是4阶的B树。

<img src="http://os310ujuc.bkt.clouddn.com/rbt6.png">

由等价性的，既然B树是平衡的，红黑树自然也是平衡的。高度h=O(logn).

通过多少个黑节点就是多少黑深度。不能出现相邻的红色节点。得红色高度不得超过黑高度两倍。

<img src="http://os310ujuc.bkt.clouddn.com/rbt.png">
