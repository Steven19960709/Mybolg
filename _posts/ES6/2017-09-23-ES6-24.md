---
layout: post
title: ES6 字符串扩展
date: 2017-09-23
tags: [ES6,JavaScript]
---

虽然，上课部分的ES6已经介绍完，但是，ES6还有很多部分是上课没讲到的，但是我觉得也需要了解一下，所以我就拿出来给大家讲讲。

# 字符串的扩展

## 字符的Unicode表示法

首先还是要先复习一下什么是Unicode。Unicode是计算机科学令页中的一项业界标准，包括字符集、编码方案等。也称统一码，万国码，单一码。Unicode 是为了解决传统的字符编码方案的局限而产生的，它为每种语言中的每个字符设定了统一并且唯一的二进制编码，以满足跨语言、跨平台进行文本转换、处理的要求。1990年开始研发，1994年正式公布。

JavaScript允许采用\xxxx形式表示一个字符，其中xxxx表示字符的Unicode码点。

    "\u0061" // "a"

但是，这种表示法只限于码点在\u0000~\uFFFF之间的字符。超出这个范围的字符，必须用两个双字节的形式表示。

    //十六进制20BB7用两个双字节表示
    "\uD842\uDFB7"
    // "𠮷"
    "\u20BB7"
    // "x7" x是未知符号

超出范围，浏览器会认为，是做一个加法处理“\u20BB” + “7”； 于是输出一个未知符号后面接一个7.

ES6改进版，可以将码点放在大括号里面。

    "\u{20BB7}" //"𠮷"
     "\uD842\uDFB7" == "\u{20BB7}" //true


## codePointAt()

这个方法可以用来处理四个字节的字符。

JavaScript内部，每个字符固定两个字节，对于一些中文字，需要四个字节来储存，JavaScript引擎会认为他们是两个字符。

例如，刚刚那个汉字“𠮷”(ji),编码表示超过了ffff所以会认为它是两个字符。JavaScript就不能正确处理，字符串长度就会误判为2，而且charAt方法无法读取整个字符。charCodeAt方法只能分别返回当前两个字节和后两个字节的值。

    var s = "𠮷";

    s.length // 2
    s.charAt(0) // ''
    s.charAt(1) // ''
    s.charCodeAt(0) // 55362
    s.charCodeAt(1) // 57271

利用这个新方法就可以正确处理4个字节的字符了。

    var s = '𠮷a';

    s.codePointAt(0) // 134071 就是十六进制的20bb7
    s.codePointAt(1) // 57271

    s.codePointAt(2) // 97

这个要注意一下，这里会看作是有三个字符 ，第一次判别的时候0位置就是整个汉字，1位置是第二个字符，汉字的后面的两个字节，2位置就是第三个字符“a”。（所以这里仍然是有些问题的）。返回的是十进制数，利用toString可以转化为十六进制。

    var s = '𠮷a';

    s.codePointAt(0).toString(16) // "20bb7"
    s.codePointAt(2).toString(16) // "61"

然后我们可以利用这个方法测试一个字符是有一个字节还是两个字节组成。

    function twoOrone(char){
        return char.codePointAt(0) > 0xffff;
    }
    twoOrone("嘿") // true
    twoOrone('h') //false

## 字符串遍历接口

之前讲过Iterator遍历器，它可以遍历字符串，现在展开讲讲。










































